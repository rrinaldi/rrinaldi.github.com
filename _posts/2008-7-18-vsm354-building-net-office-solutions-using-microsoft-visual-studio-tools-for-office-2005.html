<P>Morning on the third and "final" day of the conference.&nbsp; Final being in quotes because there&nbsp;are&nbsp;three post conference sessions on Friday. I'm going to a C# 2.0 and Visual Studio 2005.</P><P><HR></P><P>(My blog editor decided to enabling double spacing on this entry for me.&nbsp; I didn't ask it to, and I don't have time to figure out how to change it.)</P><P>Never used MSVSTO 2003, but according to the presenter (Ken Getz (sp)), it was a good start but missed the boat quite a bit.</P><P>VSTO 2005:</P><P>- Microsoft stategic tool for devloping Office solutions:</P><P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Excel 2003</P><P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Word 2003</P><P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - InfoPath 2003</P><P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Outlook 2003 add-in support</P><P>- Targetd at the professional developer</P><P>&nbsp;</P><P>Develper Productivitiy</P><P>- Integrated desing-time experience</P><P>-"It allows you to react to events from office in managed code"</P><P>&nbsp;</P><P>VB.NET is still the perferred language for office interop thanks to optional parameter support.&nbsp; Apparently VB still has a use. ( :) Hi Eric! )</P><P>In VS 2005 when you create an Excel project it loads Excel inside a tab of the VS. Even going as far as merging the menus. (At least they are a sub-menu, but it looks really, really cluttered.)</P><P>For every object in the spreadsheet, VS creates a code file that acts as sort of a code behind for that object (an object being a sheet or the workbook itself)</P><P>VSTO creates a class called Globals that contains instances of all the "code-behinds" that&nbsp;VS creates</P><P>&nbsp;The link between the assemblies that interop with excel and excel itself is stored in custom properties of the document.&nbsp; These custom properties can be deleted by anybody who has permissions to change custom properties. </P><P>VSTO 2005 has two databinding controls (NamedRange, and ListObject) so you don't need to loop through columns and rows to do your binding.&nbsp; Looks pretty sweet, and un-excelly which makes me happy. (Un-excelly meaning it doesn't feel like I'm writing VBA code in .NET)</P><P>Writing UserControls to run in the task pane looks cool.&nbsp; The document is manipulated like and XmlDocument.&nbsp; Tags are inserted into a document and the usercontrol finds and replaces the tags with data. (Yum. Token parsing, .NET style).</P><P>&nbsp;</P><P>Host Items and Host Controls</P><P>- Host Items</P><P>&nbsp;&nbsp;&nbsp;&nbsp; - Visual representation of a class</P><P>&nbsp;&nbsp;&nbsp;&nbsp; - Provide a means for displaying data</P><P>- Host Items can contain Host controls</P><P>&nbsp;&nbsp;&nbsp;&nbsp; - Excel: NamedRange and List Object</P><P>&nbsp;&nbsp;&nbsp;&nbsp; - Word: Bookmark and XmlNode</P><P>- Native objects mapped into managed code</P><P>&nbsp;</P><P>You don't need to even drag the NamedRange control onto the spreadsheet.&nbsp; Any named range on the site automagically becomes an object.</P><P>Ken got bit by code access security during the presentation.&nbsp; That is probably going to be a problem for most developers.&nbsp; I don't understand Code Access Security very well, and I'm sure most other developers don't understand it and so I think you are going to be seeing a lot of people granting full trust to everything.&nbsp; Not good.&nbsp; MS needs to get on the ball and figure out a way to teach CAS without putting people to sleep.</P><P>The VSTO com wrapper appears to hit COM way to soon for my taste.&nbsp; When you want to change fonts, it doesn't use the standard .NET Font classes.&nbsp; An Excel cell has a Value and a Value2 object, because that is what the COM object has.</P><P>Bookmarks in Word: Apparently the normal bookmarks disappear after you jack text into them.&nbsp; The new, improved BookMark .NET object doesn't die when you set the text.</P><P>What do host controls get you</P><P>-Promote items of interest into your programming model</P><P>- Office development feels more like .NET windows forms development</P><P>- Can handle events at control level, rather than at document level</P><P>- Can modify properties at design time</P><P>- All view controls support binding</P><P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - ListObject supports complex data binding</P><P>- added "correct" functionality (like the bookmark example above)</P><P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - but no existing code broken</P><P>There is no patch required to Office 2003 to run VSTO 2005 (Which means that VSTO 2005 is a hack that sits above all of the COM entry points.&nbsp; So nothing was really "fixed", they just put in some extra code that most people would have written anyway. IMHO)</P><P>Ken is going to show us how to show, edit and save data from a database in Word.&nbsp; Why, oh why would you write a word doc to edit data?</P><P>Binding seems very similiar to binding in other apps.</P><P>VSTO just blew up on Ken. :( Poor Ken.&nbsp; His machine has been doing lots of funky things during the presentation, so I'm choosing to blame him and his machine for the problems and not Microsoft or VSTO. :) (See, I'm being a good little MS fanboy!)</P><P>Demo gods are angry at Ken.&nbsp; Ken is turning a rather flattering shade of red.</P><P>Still working on that binding demo.&nbsp; Ken abandoned the binding in Word demo because he just can seem to get it to work.&nbsp; Either VS crashes on him or Word locks up. :(</P><P>All of this is very, very cool.&nbsp; Maybe if somebody had to, no matter what, work in Excel I would do some VSTO stuff for Excel.&nbsp; I was really hoping to see some Outlook stuff.&nbsp; The outlook add-in / task pane is where I see being able to add the most value.&nbsp; I'm thinking like showing a sales guy some customer information when he reads an email from that customer.&nbsp; Showing him/her things like: open support tickets, last activity with the customer, products the customer has, and trials the customer is partcipating in, etc.</P><P>Looks like I won't get to see any Outlook stuff. :( Ken is going to start showing us some taskpane stuff, so maybe I can extrapolate that into some stuff for Outlook.</P><P>(quick aside.&nbsp; If you have VBA code and .NET code that both handle similiar events (workbook loading for example) the order that the code will run is non-deterministic)</P><P>All managed controls that are on a sheet are wrapped in an ActiveX wrapper.</P><P>Why embed n ActiveX</P><P>- Secruity</P><P>- Registration</P><P>&nbsp;&nbsp;&nbsp;&nbsp; - Rather use one wrapper instead of creating a shim for each control</P><P>Whoops, everything that I've been calling a task pane is really called an action pane.&nbsp; So do a mental search and replace.</P><P>Action Panes host WinForm UserControls.&nbsp; To add a user control to an action pane, just add the control to the Controls collection.</P><P>We are running out of time, and I have to venture off to find my next session.&nbsp; I guess thats as much as I am going to learn about Action Panes.</P><P>Technorati Tags : <A href="http://technorati.com/tag/DevConnections" target=_blank rel=tag>DevConnections</A>, <A href="http://technorati.com/tag/VSTO" target=_blank rel=tag>VSTO</A><!-- End Technorati Tags --></P>