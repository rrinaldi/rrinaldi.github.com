<p><font size="2"><font face="Georgia">After </font><a href="http://blogs.geekdojo.net/jez"><font face="Georgia">Ray</font></a><font face="Georgia"> stole my thunder with his </font><a href="http://blogs.geekdojo.net/jez/posts/146.aspx"><font face="Georgia">Concatination with COALESCE</font></a><font face="Georgia">, I guess I'll have to post a different SQL script that I find handy.</font></font></p> <p><font face="Georgia" size="2">Many times I see people that need to find how many times a string is located in another instance of a string.  Normally the person figures they will just loop through the string character by character and increment a counter every time they find a match.  Not only is this prone to error, in SQL it requires the use of cursor which is “DoublyBadUnGood”<sup>TM</sup>.  Here is a quick little script that will get around this:</font></p> <p><font face="Courier New" size="2"><font color="#0000ff">DECLARE</font>  @string <font color="#0000ff">varchar</font>(100),<br />         @temp   <font color="#0000ff">varchar</font>(100),<br />         @searchstring <font color="#0000ff">varchar</font>(2)</font></p> <p><font face="Courier New" size="2"><font color="#0000ff">SET</font> @string = <font color="#ff0000">'Ryan Rinaldi'</font><br /><font color="#0000ff">SET</font> @searchstring = <font color="#ff0000">'R'</font><br /><font color="#0000ff">SELECT</font> @temp = <font color="#ff1493">REPLACE</font>(@string, @searchstring, '')</font></p> <p><font face="Courier New" size="2"><font color="#0000ff">SELECT</font> (<font color="#ff1493">LEN</font>(@string) - <font color="#ff1493">LEN</font>(@temp)) / <font color="#ff1493">LEN</font>(@searchstring)</font></p> <p><font face="Tahoma" size="2">This will come back with 2.  I know this might seem simplistic, but Hey! It works! so this isn't much more that you really need.  @searchstring can be any size, and this function would be quite easy to wrap in a User Defined Function or similar.</font></p>