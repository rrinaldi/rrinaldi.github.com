<FONT face=Verdana size=2> <P><STRONG>UPDATE:</STRONG> So I'm slow.&nbsp; There is a static method on AlternateView called CreateAltenateViewFromString() that will take a string and a ContentType and return an AlternateView instance for you.&nbsp; Next time I will read the rest of the docs (as long as they are correct!).</P> <P>In .NET 2.0, MS added System.Net.Mail (SNM)&nbsp;in favor of System.Web.Mail.&nbsp; Being the nice developer I am, I always try to send emails in HTML and plain text and let your mail client decided which one to show you. (Having a crackberry, I understand what a pain it is to get an email that is html only and not be able to read one line of the email because all you see is angle brackets.)&nbsp;&nbsp;To accomplish this in SNM, you need to set&nbsp;add an AlternateView to the AlternateViews collection.&nbsp; The code to do this is not as straight forward as one would think.&nbsp; Here is the documentation from MSDN:</P> <DIV style="BORDER-RIGHT: black 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: black 1px solid; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; OVERFLOW: auto; BORDER-LEFT: black 1px solid; WIDTH: 845px; PADDING-TOP: 5px; BORDER-BOTTOM: black 1px solid; HEIGHT: 243px; BACKGROUND-COLOR: gainsboro">&nbsp;&nbsp;&nbsp;&nbsp;<SPAN style="FONT-SIZE: 10pt; COLOR: #008000; FONT-FAMILY: Courier New">//&nbsp;Create&nbsp;a&nbsp;message&nbsp;and&nbsp;set&nbsp;up&nbsp;the&nbsp;recipients.<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">MailMessage&nbsp;message&nbsp;=&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #0000ff; FONT-FAMILY: Courier New">new&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">MailMessage(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"jane@contoso.com",<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recipients,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"This&nbsp;e-mail&nbsp;message&nbsp;has&nbsp;multiple&nbsp;views.",<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"This&nbsp;is&nbsp;some&nbsp;plain&nbsp;text.");<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #008000; FONT-FAMILY: Courier New">//&nbsp;Construct&nbsp;the&nbsp;alternate&nbsp;body&nbsp;as&nbsp;HTML.<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #0000ff; FONT-FAMILY: Courier New">string&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">body&nbsp;=&nbsp;"&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;\"-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN\"&gt;";<BR>&nbsp;&nbsp;&nbsp;&nbsp;body&nbsp;+=&nbsp;"&lt;HTML&gt;&lt;HEAD&gt;&lt;META&nbsp;http-equiv=Content-Type&nbsp;content=\"text/html;&nbsp;charset=iso-8859-1\"&gt;";<BR>&nbsp;&nbsp;&nbsp;&nbsp;body&nbsp;+=&nbsp;"&lt;/HEAD&gt;&lt;BODY&gt;&lt;DIV&gt;&lt;FONT&nbsp;face=Arial&nbsp;color=#ff0000&nbsp;size=2&gt;this&nbsp;is&nbsp;some&nbsp;HTML&nbsp;text";<BR>&nbsp;&nbsp;&nbsp;&nbsp;body&nbsp;+=&nbsp;"&lt;/FONT&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;";<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #008000; FONT-FAMILY: Courier New">//&nbsp;Add&nbsp;the&nbsp;alternate&nbsp;body&nbsp;to&nbsp;the&nbsp;message.<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">AlternateView&nbsp;alternate&nbsp;=&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #0000ff; FONT-FAMILY: Courier New">new&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">AlternateView(body,&nbsp;MediaTypeNames.Text.Html);<BR>&nbsp;&nbsp;&nbsp;&nbsp;message.AlternateViews.Add(alternate);<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #008000; FONT-FAMILY: Courier New">//&nbsp;Send&nbsp;the&nbsp;message.<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">SmtpClient&nbsp;client&nbsp;=&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #0000ff; FONT-FAMILY: Courier New">new&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">SmtpClient(server);<BR>&nbsp;&nbsp;&nbsp;&nbsp;client.Credentials&nbsp;=&nbsp;CredentialCache.DefaultNetworkCredentials;<BR>&nbsp;&nbsp;&nbsp;&nbsp;client.Send(message);<BR></DIV> <P><FONT face=Verdana>The problem being that the AlternateView constructor overload that takes a string assumes that the string is a file location.&nbsp; Whoops!&nbsp; Way to go documentation team!&nbsp; I say that jokingly, because if I wrote the docs you would be lucky if there was a single line that said more than "You're on your own dude."</FONT></P> <P><FONT face=Verdana>Back to setting up that alternate view:&nbsp; Since the AlternateView constructor that takes a string is for filenames, I started looking at the other ones I could use.&nbsp; All of them are file related, some taking a string and some taking a Stream.&nbsp; But I had a string of content, not a Stream.&nbsp; So time to go converting...</FONT></P> <P><FONT face=Verdana>To go from a string to a Stream, one needs to remember our friend MemoryStream.&nbsp; Since MemoryStream doesn't need any backing file or IO system, this is what we need.&nbsp; So what does a MemoryStream need to be "newed" up?&nbsp; A byte array.&nbsp; So, how do we go from a string to a byte array?&nbsp; System.Text.Encoding can get us there!&nbsp; We need to grab the Unicode Encoding object and ask it to convert our string to a byte array for us.&nbsp; Pass the byte array to the MemoryStream constructor and pass that to the AlternateView constructor.&nbsp; So after updating the code above to take into account all of our new code you get: </FONT></P><FONT face=Verdana></FONT><SPAN style="FONT-SIZE: 10pt; COLOR: #008000; FONT-FAMILY: Courier New"> <DIV style="BORDER-RIGHT: black 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: black 1px solid; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; OVERFLOW: auto; BORDER-LEFT: black 1px solid; WIDTH: 845px; PADDING-TOP: 5px; BORDER-BOTTOM: black 1px solid; HEIGHT: 205px; BACKGROUND-COLOR: gainsboro"><SPAN style="FONT-SIZE: 10pt; COLOR: #008000; FONT-FAMILY: Courier New">//&nbsp;Create&nbsp;a&nbsp;message&nbsp;and&nbsp;set&nbsp;up&nbsp;the&nbsp;recipients.<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">MailMessage&nbsp;message&nbsp;=&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #0000ff; FONT-FAMILY: Courier New">new&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">MailMessage(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"jane@contoso.com",<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;recipients,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"This&nbsp;e-mail&nbsp;message&nbsp;has&nbsp;multiple&nbsp;views.",<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"This&nbsp;is&nbsp;some&nbsp;plain&nbsp;text.");<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #008000; FONT-FAMILY: Courier New">//&nbsp;Construct&nbsp;the&nbsp;alternate&nbsp;body&nbsp;as&nbsp;HTML.<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #0000ff; FONT-FAMILY: Courier New">string&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">body&nbsp;=&nbsp;"&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;\"-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;Transitional//EN\"&gt;";<BR>&nbsp;&nbsp;&nbsp;&nbsp;body&nbsp;+=&nbsp;"&lt;HTML&gt;&lt;HEAD&gt;&lt;META&nbsp;http-equiv=Content-Type&nbsp;content=\"text/html;&nbsp;charset=iso-8859-1\"&gt;";<BR>&nbsp;&nbsp;&nbsp;&nbsp;body&nbsp;+=&nbsp;"&lt;/HEAD&gt;&lt;BODY&gt;&lt;DIV&gt;&lt;FONT&nbsp;face=Arial&nbsp;color=#ff0000&nbsp;size=2&gt;this&nbsp;is&nbsp;some&nbsp;HTML&nbsp;text";<BR>&nbsp;&nbsp;&nbsp;&nbsp;body&nbsp;+=&nbsp;"&lt;/FONT&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;";<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #008000; FONT-FAMILY: Courier New">//&nbsp;Add&nbsp;the&nbsp;alternate&nbsp;body&nbsp;to&nbsp;the&nbsp;message.<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">AlternateView&nbsp;alternate&nbsp;=&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #0000ff; FONT-FAMILY: Courier New">new&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">AlternateView(</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #0000ff; FONT-FAMILY: Courier New">new&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">MemoryStream(Encoding.Unicode.GetBytes(body)),&nbsp;MediaTypeNames.Text.Html));<BR>&nbsp;&nbsp;&nbsp;&nbsp;message.AlternateViews.Add(alternate);<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #008000; FONT-FAMILY: Courier New">//&nbsp;Send&nbsp;the&nbsp;message.<BR>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">SmtpClient&nbsp;client&nbsp;=&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #0000ff; FONT-FAMILY: Courier New">new&nbsp;</SPAN><SPAN style="FONT-SIZE: 10pt; COLOR: #000000; FONT-FAMILY: Courier New">SmtpClient(server);<BR>&nbsp;&nbsp;&nbsp;&nbsp;client.Credentials&nbsp;=&nbsp;CredentialCache.DefaultNetworkCredentials;<BR>&nbsp;&nbsp;&nbsp;&nbsp;client.Send(message);<BR></DIV> <P><FONT face=Verdana>Easy?&nbsp; Kinda.&nbsp; Straight forward?&nbsp; Nope.&nbsp; Is there an easier way?&nbsp; Probably, but this works.&nbsp; If I missed something, let me know.</FONT></SPAN></SPAN></SPAN> </FONT></P><!-- Powered by IMHO 1.3 (EN) Instant Blogger Copyright (c) 2005 A.Boschin - http://www.imhoproject.org -->