<p><font face="Verdana" size="2">Sometimes when building a page, I find that I need to group controls together so I can show/hide them at the same time, or perform a similar action on all of them.  Most of the time I can put them in a panel and just show/hide the panel.  Other times though the controls are located on various sections of the page that I can't put in a panel because the panel would affect more controls than I want.  So I wrote a little function that will allow me to arbitrarily group server controls on a page.  To use it, you need to add a attribute to your server controls.  You can call this attribute what ever you want and can give it any value that you want.  Then just call the little function (source code below) and it will return an ArrayList of the controls.  The even cooler part is that the attributes and their values get pushed to the client so you can even use them clientside with a little bit of JavaScript. :)  Hopefully you'll find it handy.</font></p> <p><font face="Verdana" size="2"><span style="FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent"><span style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">        /// <summary><br /> <font color="#000000">        </font><span style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">/// Returns an ArrayList of Controls that have the specified attributeName and attributeValue.</span><br /> <font color="#000000">        </font><span style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">/// If attributeValue is null, it will return controls that only have the specified attributeName</span><br /> <font color="#000000">        </font><span style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">/// </summary></span><br /> <font color="#000000">        </font><span style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">/// <param name="attributeName">Name of the attribute to look for</param></span><br /> <font color="#000000">        </font><span style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">/// <param name="attributeValue">Value of the attribute specified in attributeName.</param></span><br /> <font color="#000000">        </font><span style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">/// <param name="controls">ControlsCollection to look in</param></span><br /> <font color="#000000">        </font><span style="FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">/// <returns>ArrayList of Controls</returns></span><br /> <font color="#000000">        </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">protected</span> <font color="#000000">ArrayList GetControlsByAttribute(</font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">string</span> <font color="#000000">attributeName,</font> <span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">string</span> <font color="#000000">attributeValue, ControlCollection controls)<br />         {<br />             ArrayList myControls</font> <span style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</span> <span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">new</span> <font color="#000000">ArrayList();<br />             <br />             </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">foreach</span><font color="#000000">(Control control</font> <span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">in</span> <font color="#000000">controls)<br />             {<br />                 </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">if</span><font color="#000000">(control.HasControls())<br />                 {<br />                     ArrayList childControls</font> <span style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</span> <font color="#000000">GetControlsByAttribute(attributeName, attributeValue, control.Controls);<br />                     </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">foreach</span><font color="#000000">(Control childControl</font> <span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">in</span> <font color="#000000">childControls)<br />                     {<br />                         myControls.Add(childControl);<br />                     }<br />                 }<br /> <br />                 System.Reflection.PropertyInfo[] props;<br />                 props</font> <span style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</span> <font color="#000000">control.GetType().GetProperties();<br /> <br />                 </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">for</span><font color="#000000">(</font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">int</span> <font color="#000000">i</font> <span style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</span> <font color="#000000">0; i < props.Length; i++ )<br />                 {<br />                     </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">if</span><font color="#000000">( props[i].Name ==</font> <span style="FONT-SIZE: 11px; COLOR: #666666; FONT-FAMILY: Courier New; BACKGROUND-COLOR: #e4e4e4">"Attributes"</span> <font color="#000000">)<br />                     {<br />                         System.Web.UI.AttributeCollection ac</font> <span style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</span> <font color="#000000">(System.Web.UI.AttributeCollection) props[i].GetValue(control,</font> <span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">null</span><font color="#000000">);<br />                         <br />                         </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">if</span><font color="#000000">( attributeValue !</font><span style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</span> <span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">null</span> <font color="#000000">)<br />                         {<br />                             </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">if</span><font color="#000000">( ac[attributeName] == attributeValue)<br />                             {<br />                                 myControls.Add(control);<br />                             }<br />                         }<br />                         </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">else</span><br /> <font color="#000000">                        {<br />                             </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">if</span><font color="#000000">( ac[attributeName] !</font><span style="FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">=</span> <span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">null</span><font color="#000000">)<br />                             {<br />                                 myControls.Add(control);<br />                             }<br />                         }<br />                         </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">break</span><font color="#000000">;<br />                     }<br />                 }<br />             }<br />             </font><span style="FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Courier New; BACKGROUND-COLOR: transparent">return</span> <font color="#000000">myControls;<br />         }</font></span></span></font></p>