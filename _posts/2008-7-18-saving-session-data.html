<p><font face="Georgia" size="2">So, I'm cruising around the blogsphere today and I happen to come across this this </font><a href="http://neopoleon.com/blog/posts/1608.aspx"><font face="Georgia" size="2">post</font></a><font face="Georgia" size="2"> by Rory. (Actually I didn't stumble across it, I subscribe to his RSS feed, but don't tell him that.  He might get an ego or something. :) )  Rory makes reference to a </font><a href="http://hyperthink.net/blog/PermaLink.aspx?guid=6d6c9a73-42a1-4fec-86a1-e0e58a410eb4"><font face="Georgia" size="2">post</font></a><font face="Georgia" size="2"> written by Steve Maine.  Go read it, then come back.</font></p> <p><font face="Georgia" size="2">Okay, here's the deal.  I like the fact that Steve's post removes unnecessary string literals from code (string literals are Magic Numbers' younger, less ugly sister), but I don't think that his methods give as great of speed improvements as he is talking about.</font></p> <p><font face="Georgia" size="2">Lets take his example:</font></p> <blockquote dir="ltr" style="MARGIN-RIGHT: 0px"> <p><span style="FONT-SIZE: 9pt; FONT-FAMILY: 'Lucida Console'">newOrder.CreditCard      = (CreditCardInfo)HttpContext.Current.Session[CREDITCARD_KEY];<br />newOrder.BillingAddress  = (AddressInfo)HttpContext.Current.Session[BILLING_KEY];<br />newOrder.ShippingAddress = (AddressInfo)HttpContext.Current.Session[SHIPPING_KEY];</span></p></blockquote> <p dir="ltr"><span style="FONT-SIZE: 9pt; FONT-FAMILY: 'Lucida Console'"><font face="Georgia" size="2">He wants the above changed to read something like the following:</font></span></p> <blockquote dir="ltr" style="MARGIN-RIGHT: 0px"> <p dir="ltr"><span style="FONT-SIZE: 9pt; FONT-FAMILY: 'Lucida Console'">SessionDataContainer sessionState = HttpContext.Current.Session[ CONTAINER KEY ];<br /><br />newOrder.CreditCard      = sessionState.CREDITCARD;<br />newOrder.BillingAddress  = sessionState.BILLING;<br />newOrder.ShippingAddress = sessionState.SHIPPING;</span></p></blockquote> <p dir="ltr"><span style="FONT-SIZE: 9pt; FONT-FAMILY: 'Lucida Console'"><font face="Georgia" size="2">Comparing the two snippets of code, I definitely prefer the latter.  If you ever ask anybody I have ever <a href="http://blogs.geekdojo.net/jez">worked</a> <a href="http://blogs.geekdojo.net/richard">with</a>, they will tell you how much I hate magic numbers.  (Steve needs to run his code through FxCop though.  Public member variables? All uppercase variable names?)</font></span></p> <p dir="ltr"><font size="2"><font face="Georgia"><span style="FONT-SIZE: 9pt; FONT-FAMILY: 'Lucida Console'"><font face="Georgia"><font size="2">For code maintainability the above solution is great.  </font></font></span><span style="FONT-SIZE: 9pt; FONT-FAMILY: 'Lucida Console'"><font face="Georgia" size="2">The problem I have is that Steve is assuming in-process session management.  With out-of-process session management instead of having 3 objects that you can access randomly when you need them, you now have one larger object that needs to be serialized and deserialized. </font></span></font></font><span style="FONT-SIZE: 9pt; FONT-FAMILY: 'Lucida Console'"><font face="Georgia" size="2">Let's say that I only need the shipping address.  Why should I need to deserialize the credit card and billing address objects? That is a huge performance hit!  Whatever gains in speed you had before you have just completely annihilated by moving to out-of-process memory management.</font></span></p> <p dir="ltr"><span style="FONT-SIZE: 9pt; FONT-FAMILY: 'Lucida Console'"><font face="Georgia" size="2">If you are looking to solve some maintainability issues, Steve's post is a brilliant way to make source code cleaner.  If your looking to speed up your code, I don't think you will gain incredible amounts of speed by adding a strongly typed container to your session lookups.</font></span></p>