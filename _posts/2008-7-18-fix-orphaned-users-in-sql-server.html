<p><font face="Verdana" size="2">Every time I restore&nbsp;a database, I forget how to fix the orphaned users.&nbsp; So I google, trying to find the magic words that will bring me to that stored procedure that I know exists, but I just can't remember the name of.&nbsp; For those of you who don't know, sp_change_users_login has an 'Auto_Fix' action that will map a user in a database to a login of the same name. Since I'm going to forget all that again, I'm posting this little snippet of Books Online.&nbsp; Maybe Google will help me find it next time!</font></p> <h1><font face="Verdana" size="2"><a name="_sp_change_users_login" id="_sp_change_users_login"></a><font size="2">sp_change_users_login</font></font></h1> <p>Changes the relationship between a Microsoft&reg; SQL Server&trade; login and a SQL Server user in the current database.</p> <h5>Syntax</h5> <p><b>sp_change_users_login</b> [ <b>@Action</b> <b>=</b> ] <b>'</b><i>action</i><b>'</b><br /> &nbsp;&nbsp;&nbsp;&nbsp;[ <b>,</b> [ <b>@UserNamePattern</b> <b>=</b> ] <b>'</b><i>user</i><b>'</b> ]<br /> &nbsp;&nbsp;&nbsp;&nbsp;[ <b>,</b> [ <b>@LoginName</b> <b>=</b> ] <b>'</b><i>login</i><b>'</b> ]</p> <h5>Arguments</h5> <p>[<b>@Action</b> <b>=</b>] <b>'</b><i>action</i><b>'</b></p> <p class="indent">Describes the action to be performed by the procedure. <i>action</i> is <b>varchar(10),</b> and can be one of these values.</p> <table cols="2" cellpadding="2" rules="all" width="563" border="1" frame="box"> <tbody> <tr valign="top"> <th class="label" width="22%"><font size="2">Value</font></th> <th class="label" width="78%"><font size="2">Description</font></th></tr> <tr valign="top"> <td width="22%"><b><font size="2">Auto_Fix</font></b></td> <td width="78%"><font size="2">Links user entries in the <b>sysusers</b> table in the current database to logins of the same name in <b>syslogins</b>. It is recommended that the result from the <b>Auto_Fix</b> statement be checked to confirm that the links made are the intended outcome. Avoid using <b>Auto_Fix</b> in security-sensitive situations. <b>Auto_Fix</b> makes best estimates on links, possibly allowing a user more access permissions than intended.</font> <p><font size="2"><i>user</i> must be a valid user in the current database, and <i>login</i> must be NULL, a zero-length string (''), or not specified.</font></p></td></tr> <tr valign="top"> <td width="22%"><b><font size="2">Report</font></b></td> <td width="78%"><font size="2">Lists the users, and their corresponding security identifiers (SID), that are in the current database, not linked to any login.</font> <p><font size="2"><i>user</i> and <i>login</i> must be NULL, a zero-length string (''), or not specified.</font></p></td></tr> <tr valign="top"> <td width="22%"><b><font size="2">Update_One</font></b></td> <td width="78%"><font size="2">Links the specified <i>user</i> in the current database to <i>login. login</i> must already exist. <i>user</i> and <i>login</i> must be specified.</font></td></tr></tbody></table> <br /> <br /> <br /> <p>[<b>@UserNamePattern</b> <b>=</b>] <b>'</b><i>user</i><b>'</b></p> <p class="indent">Is the name of a SQL Server user in the current database. <i>user</i> is <b>sysname</b>, with a default of NULL. <b>sp_change_users_login</b> can be used only with the security accounts of SQL Server logins and users; it cannot be used with Microsoft Windows NT&reg; users.</p> <p>[<b>@LoginName</b> <b>=</b>] <b>'</b><i>login</i><b>'</b></p> <p class="indent">Is the name of a SQL Server login. <i>login</i> is <b>sysname</b>, with a default of NULL.</p> <h5>Return Code Values</h5> <p>0 (success) or 1 (failure)</p>